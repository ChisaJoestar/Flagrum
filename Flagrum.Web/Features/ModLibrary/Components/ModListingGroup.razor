@inject AppStateService AppState
@inject JSInterop Interop

<CascadingValue Value="this">
    @foreach (var mod in Mods)
    {
        <ModListingCard @key="mod.Uuid" Mod="mod"/>
    }
</CascadingValue>

@code
{
    [Parameter]
    public IEnumerable<Binmod> Mods { get; set; }

    private List<ModListingCard> Children { get; set; } = new();

    // protected override async Task OnAfterRenderAsync(bool firstRender)
    // {
    //     await base.OnAfterRenderAsync(firstRender);
    //     foreach (var uuid in Children.Select(c => c.Mod.Uuid).ToList())
    //     {
    //         await Interop.SetBackgroundImage(uuid);
    //     }
    // }

    public void AddChild(ModListingCard child)
    {
        Children.Add(child);
    }

    public void CallStateHasChanged()
    {
        StateHasChanged();
    }
}